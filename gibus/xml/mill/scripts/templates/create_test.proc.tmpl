
--
-- test creating and deleting records  
--
--
   $procedureHeader
      --
      -- local print iteration routine
      --
      $printHeader
      $variableDeclaration;
      begin
         $retrieveUser;
         $toString;
      end print;

   
      $variableDeclaration;
      $listDeclaration;
      criteria  : d.Criteria;
      startTime : Time;
      endTime   : Time;
      elapsed   : Duration;
   begin
      startTime := Clock;
      Logger.info( "Starting test $procName" );
      
      Logger.info( "Clearing out the table" );
      $clearTable;
      
      Logger.info( "$procName: create tests" );
      for i in 1 .. RECORDS_TO_ADD loop
         #for k in $createKeyStatements:
         $k;
         #end for;
         #for d in $createDataStatements:         
         $d;
         #end for;
         $saveStatement;         
      end loop;
      
      $completeListStatement;
      
      Logger.info( "$procName: alter tests" );
      for i in 1 .. RECORDS_TO_ALTER loop
         $elementFromList;
         #for d in $modifyDataStatements:
         $d;
         #end for;         
         $updateStatement;         
      end loop;
      
      Logger.info( "$procName: delete tests" );
      for i in RECORDS_TO_DELETE .. RECORDS_TO_ADD loop
         $elementFromList;
         $deleteStatement;         
      end loop;
      
      Logger.info( "$procName: retrieve all records" );
      $iterate;
      endTime := Clock;
      elapsed := endTime - startTime;
      Logger.info( "Ending test $procName. Time taken = " & elapsed'Img );

   exception 
      when Error : others =>
         Logger.error( "$procName execute query failed with message " & Exception_Information(Error) );
         assert( False,  
            "$procName : exception thrown " & Exception_Information(Error) );
   end $procName;
